package com.myFuzzyProject;

import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.GridLayout;
import java.awt.TextField;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JOptionPane;
import javax.swing.JPanel;
import javax.swing.JTextField;
import javax.swing.text.JTextComponent;
import javax.swing.text.MaskFormatter;

import org.antlr.tool.Message;

import net.sourceforge.jFuzzyLogic.FIS;
import net.sourceforge.jFuzzyLogic.FunctionBlock;
import net.sourceforge.jFuzzyLogic.plot.JFuzzyChart;
import net.sourceforge.jFuzzyLogic.rule.Variable;

public class MBIClass extends JFrame implements ActionListener {
	
	JTextField text;
	JTextField text2;
	 String s1="1";
	 String s2="1";
	 JLabel label3;
	 JLabel label4;
	 JButton b_buttom;
	 JButton exit;
	 JLabel label;
	 JLabel label2;
	 String filename;
	 FIS fis;
	 Float y;
	 Float x;
	public MBIClass(){
		super("BMI");
		setSize(400, 200);
		setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
		
		setLayout(new GridLayout(4, 2));
		label = new JLabel("   Please enter Weight :");
		add(label);
		text = new JTextField(3);
		
		add(text);
		label2 = new JLabel("   Please enter Hight :");
		add(label2);
		text2 = new JTextField(3);
		add(text2);
		
	    label3 = new JLabel("   BMI Fuzzy :..........................");
	    
		add(label3);
		label4 = new JLabel("BMI Original :..........................");
		add(label4);

		
		 b_buttom = new JButton("Get bmi");
		 b_buttom.addActionListener(this);
		add(b_buttom);

		 exit = new JButton("Exit");
		 exit.addActionListener(this);
		add(exit);
		text2.setToolTipText("لطفا بر حسب سانتیمتر وارد کنید");
		text.setToolTipText("لطفا بر حسب کیلوگرم وارد کنید");
		text.setSelectionColor(Color.yellow);
		text2.setSelectionColor(Color.yellow);
		text.setSelectedTextColor(Color.blue);
		text2.setSelectedTextColor(Color.blue);
		
//		JPanel panel = new JPanel();
//		panel.setLayout(new BorderLayout());
//		panel.setBackground(Color.blue);
//		text = new JTextField(5);
//		panel.add(text,BorderLayout.EAST);
//		JLabel label = new JLabel("enter Weight :");
//		panel.add(label,BorderLayout.WEST);
//		add(panel,BorderLayout.SOUTH);
//		/////////////////////////////////////////////////
//		JPanel panel2 = new JPanel();
//		panel2.setLayout(new BorderLayout());
//		panel2.setBackground(Color.pink);
//		text2 = new JTextField(5);
//		panel2.add(text2,BorderLayout.EAST);
//		JLabel label2 = new JLabel("enter hight :");
//		panel2.add(label2,BorderLayout.WEST);
//		add(panel2,BorderLayout.SOUTH);
//		s1=text.getText();
//		s2=text2.getText();
//		
	}
	public static void main(String[] args) throws Exception {
		
		MBIClass gui = new MBIClass();
		gui.setVisible(true);
		
		
	}


	public void bmi(){
		
		s1=text.getText();
		s2=text2.getText();
		try {
			filename = "bmi.fcl";
			//System.out.println("BMI: " + "Weight");
			//Float x= (float) System.in.read();
//			System.out.println("BMI: " + "y");
//			Float y= (float) System.in.read();
		
			 fis = FIS.load(filename, true);
		
		} catch (Exception e) {
			JOptionPane.showMessageDialog(this, "Don't file BMI.fcl "  ," Error ", JOptionPane.PLAIN_MESSAGE);
		}
				
			
			//y=(float) 170.5;
			//x=(float) 60;
					try {

						y=Float.parseFloat(s2);
						x=Float.parseFloat(s1);
						if (50>x || x>150) {
							JOptionPane.showMessageDialog(this, "Are you sure correct number"  ," Caution ", JOptionPane.PLAIN_MESSAGE);
						}
						if (110>y || y>200) {
							JOptionPane.showMessageDialog(this, "Are you sure correct number"  ," Caution ", JOptionPane.PLAIN_MESSAGE);
						}
					} catch (Exception e) {
						JOptionPane.showMessageDialog(this, "Please enter number"  ," Error ", JOptionPane.PLAIN_MESSAGE);
						
					}
			try {
			//y=(float) prompt_number () ;
			//System.out.println("BMI: " + "hight");
			//x= (float) prompt_number () ;
			
			if (fis == null) {
				System.err.println("Can't load file: '" + filename + "'");
				System.exit(1);
			}

			// Get default function block
			FunctionBlock fb = fis.getFunctionBlock(null);

			// Set inputs
			fb.setVariable("hight",y);
			
			fb.setVariable("Weight",x);

			// Evaluate
			fb.evaluate();

			// Show output variable's chart
			fb.getVariable("BMI").defuzzify();

		
			// Print ruleSet
		//	System.out.println(fb);
			Float hh1=y/100;
			Float hh=hh1*hh1;
			Float m3=x/hh;
			m3=(float) Math.ceil(m3);
			
			float f= (float) fb.getVariable("BMI").getValue();
			f=(float) Math.ceil(f);
			label3.setText("BMI Fuzzy: " + f);
			
			label4.setText(""+"BMI  Original : " + m3.toString());
			//JOptionPane.showMessageDialog(this, "This is the dialog message"  ,"This is the dialog title", JOptionPane.PLAIN_MESSAGE);
//			
//			System.out.println("BMI: " + hhh.toString());
//			System.out.println("BMI: " + x.toString()+y.toString());
//			System.out.println("BMI: " + fb.getVariable("BMI").getValue());

			
		} catch (Exception e) {
			   System.out.println("incorrent");
		}
		
	}
	static int prompt_number () 
    {
      BufferedReader number=new BufferedReader(new InputStreamReader(System.in));
  
             int c = 0 ;
             String aa;
             try {
            	 aa=number.readLine();
            	        
                        //c=number.read();
                       // c= c-48;
                        
                      
             } catch (IOException ex) {
                    System.out.println("incorrent");
             }
                                        
                 
                      
          return c;  
    }
	@Override
	public void actionPerformed(ActionEvent e) {
		String ee = e.getActionCommand();
		if (ee.equals("Get bmi")) {
			bmi();
		}
		if (ee.equals("Exit")) {
			System.exit(0);
		}
		
	}

}
